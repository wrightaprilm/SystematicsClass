<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>RevBayes Total Evidence Tree Estimation • SystematicsClass</title>
<!-- jquery --><script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.4.1/jquery.min.js" integrity="sha256-CSXorXvZcTkaix6Yvo6HppcZGetbYMGWSFlBw8HfCJo=" crossorigin="anonymous"></script><!-- Bootstrap --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/css/bootstrap.min.css" integrity="sha256-bZLfwXAP04zRMK2BjiO8iu9pf4FbLqX6zitd+tIvLhE=" crossorigin="anonymous">
<script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/js/bootstrap.min.js" integrity="sha256-nuL8/2cJ5NDSSwnKD8VqreErSWHtnEP9E7AySL+1ev4=" crossorigin="anonymous"></script><!-- bootstrap-toc --><link rel="stylesheet" href="../../bootstrap-toc.css">
<script src="../../bootstrap-toc.js"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous">
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous">
<!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- pkgdown --><link href="../../pkgdown.css" rel="stylesheet">
<script src="../../pkgdown.js"></script><meta property="og:title" content="RevBayes Total Evidence Tree Estimation">
<meta property="og:description" content="SystematicsClass">
<!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]-->
</head>
<body data-spy="scroll" data-target="#toc">
    

    <div class="container template-article">
      <header><div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <span class="navbar-brand">
        <a class="navbar-link" href="../../index.html">SystematicsClass</a>
        <span class="version label label-default" data-toggle="tooltip" data-placement="bottom" title="">0.2.0</span>
      </span>
    </div>

    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
<li>
  <a href="../../reference/index.html">Reference</a>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" aria-expanded="false">
    Articles
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu">
<li>
      <a href="../../articles/00_Basics_of_R/index.html">R Reminder</a>
    </li>
    <li>
      <a href="../../articles/01_homology_assignment/index.html">Morphological Homology Assignment</a>
    </li>
    <li>
      <a href="../../articles/02_molecular_homology/index.html">Molecular Homology Assignment</a>
    </li>
    <li>
      <a href="../../articles/03_massive_homology/index.html">Genome-Scale Homology</a>
    </li>
    <li>
      <a href="../../articles/04_ParsimonyAndModels/index.html">PAUP, parsimony, and nucletoide substitution models</a>
    </li>
    <li>
      <a href="../../articles/06_Bayes_and_MCMC/index.html">Introduction to MCMC using RevBayes</a>
    </li>
    <li>
      <a href="../../articles/07_molecular_data/index.html">Nucleotide substitution models</a>
    </li>
    <li>
      <a href="../../articles/08_Discrete_Morphology/index.html">Discrete morphology - Models and Tree Inference</a>
    </li>
    <li>
      <a href="../../articles/09_Partitioned_data/index.html">Partitioned data analysis</a>
    </li>
    <li>
      <a href="../../articles/10_Molecular_Clock/index.html">Tripartite Model 2 - Clock Models for Character Data</a>
    </li>
    <li>
      <a href="../../articles/11_FBD/RB_Total_Evidence_Tutorial.html">RevBayes Total Evidence Tree Estimation</a>
    </li>
    <li>
      <a href="../../articles/13_Comparative_Methods/index.html">Phylogenetic Comparative Methods for Paleobiology</a>
    </li>
    <li>
      <a href="../../articles/14_biogeography/index.html">Introduction to Phylogenetic Models of Discrete Biogeography</a>
    </li>
    <li>
      <a href="../../articles/15_Final/index.html">FinalExam</a>
    </li>
    <li>
      <a href="../../articles/LCalc/LikelihoodCalc.html">LikelihoodCalc</a>
    </li>
    <li>
      <a href="../../articles/ModelsHomework/index.html">Models Homework</a>
    </li>
    <li>
      <a href="../../articles/PaupHomework/index.html">PAUPHomework</a>
    </li>
  </ul>
</li>
      </ul>
<ul class="nav navbar-nav navbar-right"></ul>
</div>
<!--/.nav-collapse -->
  </div>
<!--/.container -->
</div>
<!--/.navbar -->

      

      </header><div class="row">
  <div class="col-md-9 contents">
    <div class="page-header toc-ignore">
      <h1 data-toc-skip>RevBayes Total Evidence Tree Estimation</h1>
            
      
      
      <div class="hidden name"><code>RB_Total_Evidence_Tutorial.Rmd</code></div>

    </div>

    
    
<p>This tutorial builds upon the previous three tutorials to estimate a dated phylogeny from discrete morphological data using the Fossilized Birth-Death Model (FBD) <span class="citation">(<span class="citeproc-not-found" data-reference-id="stadler2010"><strong>???</strong></span>; <span class="citeproc-not-found" data-reference-id="heath2014"><strong>???</strong></span>)</span>. Broadly, the FBD model is a “total-evidence” model and can incorporate fossil ages, molecular data, and morphological data to estimate a tree with branch lengths in units of absolute time. In this tutorial, we will focus on fossil ages and morphological data to estimate our phylogeny. Using an example from a 2013 by Zamora et al., we will estimate a total evidence phylogeny of the Cinctans.</p>
<div class="section level2">
<h2 id="introduction">Introduction<a class="anchor" aria-label="anchor" href="#introduction"></a>
</h2>
<p><img src="figures/TotalEvidence.png"><em>Figure One: A representation of the data required for and model subcomponents of the Fossilized Birth-Death model</em></p>
<p>The above figure (Warnock and Wright 2020) demonstrates the “total-evidence” framework of the FBD model. In this model, there are three submodels. One describes cahracter change (the substitution model), one describes how rates of evolution are distributed across the tree (the clock model), and the final component describes how speciation, extinction and fossil sampling events are distributed in time (the tree model). The substitution and clock models have been discussed in the previous two tutorials.</p>
<p>Below is an image from Warnock and Wright (2020) showing the true tree and the reconstructed tree. The reconstructed tree is the tree we are capable of inferring from our fossil phylogenetic characters and our fossil ages. The true tree, on the other hand, is unkowable, as we will never have complete sampling in the past and the present.</p>
<p><img src="figures/figure5.png"><em>Figure Two: Different sets of FBD parameters can give rise to different reconstructed trees</em></p>
<div class="section level3">
<h3 id="tree-model">Tree model<a class="anchor" aria-label="anchor" href="#tree-model"></a>
</h3>
<p>In this tutorial, we will explain a prior on topologies, divergence times, and macroevolutionary parameters called the <em>fossilized birth-death</em> (FBD) process <span class="citation">(Stadler 2010; Heath, Huelsenbeck, and Stadler 2014)</span>. This manner of divergence time estimation is different than other approaches. For example, you may be familiar with <em>node calibration</em> approaches, in which the age of a fossil is used to constrain the age of a node. While these approaches have historically been well-used, the FBD makes more complete use of the fossil record. This is because the FBD, as shown on figure 1, is a hierarchical prior. This allows us to model the evolution of morphological characters to place specimens on the tree. Rather than using only the age information, and telling the method where the fossil goes, the placement of the fossil can be estimated in the analysis. Taxa without phylogenetic characters can still be used in this analysis. While they cannot be placed using a character model, the FBD model marginalizes over possible placements for a taxon, which allows for the age information to still be used.</p>
<p>The FBD model is a macroevolutionary model describing the process of speciation ( the addition of lineages to the tree - $ $), extinction (the removal of lineages from a population - $ $), fossil sampling (recovery of lineages in the past - $ $) and extant sampling (recovery of contemporaneous lineages - $ <span class="math inline">\(). Origin time (\)</span> $) describes the time at which the process of diversification and sampling began in your lineage.</p>
<p><img src="figures/tikz/fbd_gm-eps-converted-to.png"><em>Figure Three: A graphical model showing the FBD from a <a href="https://revbayes.github.io/tutorials/fbd/" class="external-link">tutorial</a> by Heath, Wright and Pett can be seen below.</em></p>
<p>As shown in Fig. 2, different combinations of these parameters can lead to different shapes of the reconstructed tree. In all of these simulations, the lineage begins with one lineage at 40 million years ago. As can be seen on the figure, different sets of parameters can lead to more samples in the past, or fewer. Parameters such as extinction and speciation can lead to different number of nodes on the tree. And fossil sampling generates the possibility that some sampled fossils actually lie as 2-degree nodes. That is, they did not go extinct when sampled, and have descendents on the phylogeny.</p>
</div>
</div>
<div class="section level2">
<h2 id="example-estimating-the-phylogeny-and-divergence-times-of-fossil-cinctans">Example: Estimating the Phylogeny and Divergence Times of Fossil Cinctans<a class="anchor" aria-label="anchor" href="#example-estimating-the-phylogeny-and-divergence-times-of-fossil-cinctans"></a>
</h2>
<p>In this exercise, we will combine different types of data from 23 fossil species. For the fossil species, occurrence times are obtained from the literature or fossil databases like the <a href="http://fossilworks.org/" class="external-link">Fossilworks PaleoDB</a> or the <a href="http://fossilcalibrations.org/" class="external-link">Fossil Calibration Database</a>, or from your own paleontological expertise. |</p>
<div class="section level4">
<h4 id="load-taxon-list">Load Taxon List<a class="anchor" aria-label="anchor" href="#load-taxon-list"></a>
</h4>
<p>First, we will load in a list of all the taxa that will be in our analysis. This includes taxa for which we have morphological data, and taxa for which we only have ages. We will load the <code>cinctans_taxa.tsv</code> file using the <code>readTaxonData()</code> function.</p>
<div class="sourceCode" id="cb1"><pre class="downlit sourceCode r">
<code class="sourceCode R">    <span class="va">taxa</span> <span class="op">&lt;-</span> <span class="fu">readTaxonData</span><span class="op">(</span><span class="st">"data/cincta_fossil_intervals_FA.tsv"</span><span class="op">)</span></code></pre></div>
<p>This function reads a tab-delimited file and creates a variable called <code>taxa</code> that is a list of all of the taxon names relevant to this analysis. This list includes all of cinctans we are adding to the tree. Because fossils are data under the FBD model, even in the absence of phylogenetic characters, they are included in the file.</p>
</div>
<div class="section level4">
<h4 id="load-data-matrices">Load Data Matrices<a class="anchor" aria-label="anchor" href="#load-data-matrices"></a>
</h4>
<p><code>RevBayes</code> uses the function <code>readDiscreteCharacterData()</code> to load a data matrix to the workspace from a Nexus formatted file. This function can be used for both discrete morphological characters and molecular characters, if you have them.</p>
<p>Import the morphological character matrix and assign it to the variable <code>morpho</code>.</p>
<div class="sourceCode" id="cb2"><pre class="downlit sourceCode r">
<code class="sourceCode R">    <span class="va">morpho</span> <span class="op">&lt;-</span> <span class="fu">readDiscreteCharacterData</span><span class="op">(</span><span class="st">"data/Cinctans.nex"</span><span class="op">)</span></code></pre></div>
</div>
<div class="section level4">
<h4 id="create-helper-variables">Create Helper Variables<a class="anchor" aria-label="anchor" href="#create-helper-variables"></a>
</h4>
<p>Before we begin writing the <code>Rev</code> scripts for each of the model components, we need to instantiate a couple “helper variables” that will be used by downstream parts of running and using our models. These variables will be used in multiple places in the analysis, and so we will instantiate them before going any further.</p>
<p>Create a new constant node called <code>n_taxa</code> that is equal to the number of species in our analysis (22).</p>
<div class="sourceCode" id="cb3"><pre class="downlit sourceCode r">
<code class="sourceCode R">    <span class="va">n_taxa</span> <span class="op">&lt;-</span> <span class="fu">taxa.size</span><span class="op">(</span><span class="op">)</span> 
    <span class="va">num_branches</span> <span class="op">&lt;-</span> <span class="fl">2</span> <span class="op">*</span> <span class="va">n_taxa</span> <span class="op">-</span> <span class="fl">2</span></code></pre></div>
<p>Next, create a workspace variable called <code>moves</code>. This variable is an iterator that will build a vector containing all of the MCMC moves used to propose new states for every stochastic node in the model graph. Each time we add a parameter to the model, and put a prior on it, this will be incremented by <code>1</code>.</p>
<div class="sourceCode" id="cb4"><pre class="downlit sourceCode r">
<code class="sourceCode R">    <span class="va">moves</span> <span class="op">=</span> <span class="fu">VectorMoves</span><span class="op">(</span><span class="op">)</span>
    <span class="va">monitors</span> <span class="op">=</span> <span class="fu">VectorMonitors</span><span class="op">(</span><span class="op">)</span></code></pre></div>
<p>Moves and monitors are part of the RevBayes workspace. They are not parameters of the model. They specify how values for parameters will be sampled. Because they are in the workspace, they are specified with the <code>=</code> operator, rather than the assignment operator <code>&lt;-</code>.</p>
</div>
<div class="section level3">
<h3 id="the-fossilized-birth-death-process">The Fossilized Birth-Death Process<a class="anchor" aria-label="anchor" href="#the-fossilized-birth-death-process"></a>
</h3>
<div class="section level4">
<h4 id="speciation-and-extinction-rates">Speciation and Extinction Rates<a class="anchor" aria-label="anchor" href="#speciation-and-extinction-rates"></a>
</h4>
<p>We will begin by specifying the speciation and extinction rates. These parameters govern the rate at which lineages are added to and removed from the population. From a previous study we know that an expoential distribution with a parameter of 1.471 is a reasonable distribution in which this value could lie.</p>
<div class="sourceCode" id="cb5"><pre class="downlit sourceCode r">
<code class="sourceCode R">  <span class="va">speciation_rate</span> <span class="op">~</span> <span class="fu">dnExponential</span><span class="op">(</span><span class="fl">1.471</span><span class="op">)</span>

  <span class="fu">moves.append</span><span class="op">(</span><span class="fu">mvScale</span><span class="op">(</span><span class="va">speciation_rate</span>, lambda<span class="op">=</span><span class="fl">0.01</span>, weight<span class="op">=</span><span class="fl">5</span><span class="op">)</span><span class="op">)</span>;
  <span class="fu">moves.append</span><span class="op">(</span><span class="fu">mvScale</span><span class="op">(</span><span class="va">speciation_rate</span>, lambda<span class="op">=</span><span class="fl">0.10</span>, weight<span class="op">=</span><span class="fl">3</span><span class="op">)</span><span class="op">)</span>;
  <span class="fu">moves.append</span><span class="op">(</span><span class="fu">mvScale</span><span class="op">(</span><span class="va">speciation_rate</span>, lambda<span class="op">=</span><span class="fl">1.00</span>, weight<span class="op">=</span><span class="fl">1</span><span class="op">)</span><span class="op">)</span>;</code></pre></div>
<p>It is possible to set extinction as its own parameter, for example, like so:</p>
<div class="sourceCode" id="cb6"><pre class="downlit sourceCode r">
<code class="sourceCode R">  <span class="va">extinction_rate</span> <span class="op">~</span> <span class="fu">dnExponential</span><span class="op">(</span><span class="fl">10</span><span class="op">)</span></code></pre></div>
<p>However, extinction and speciation rates are often correlated. And so we will instantiate a parameter called turnover, which is the ratio of extinction rate to speciation rate ($ $ / $ $). The parameters to this lognormal distribution were arrived at by simulation of parameter values from the data.</p>
<div class="sourceCode" id="cb7"><pre class="downlit sourceCode r">
<code class="sourceCode R">    <span class="va">turnover</span> <span class="op">~</span> <span class="fu">dnLognormal</span><span class="op">(</span><span class="fl">0.945</span>, <span class="fl">1.926745</span><span class="op">)</span>;
    <span class="fu">moves.append</span><span class="op">(</span><span class="fu">mvSlide</span><span class="op">(</span><span class="va">turnover</span>, delta<span class="op">=</span><span class="fl">0.01</span>, weight<span class="op">=</span><span class="fl">5</span><span class="op">)</span><span class="op">)</span>
    <span class="fu">moves.append</span><span class="op">(</span><span class="fu">mvSlide</span><span class="op">(</span><span class="va">turnover</span>, delta<span class="op">=</span><span class="fl">0.10</span>, weight<span class="op">=</span><span class="fl">3</span><span class="op">)</span><span class="op">)</span>
    <span class="fu">moves.append</span><span class="op">(</span><span class="fu">mvSlide</span><span class="op">(</span><span class="va">turnover</span>, delta<span class="op">=</span><span class="fl">1.00</span>, weight<span class="op">=</span><span class="fl">1</span><span class="op">)</span><span class="op">)</span></code></pre></div>
<p>As discussed in previous lessons, moves specify how often (<em>weight</em>), we will sample new values for the parameters in our model. The <em>delta</em> of the slide move specifies how different from the initial value a propsed new parameter will be. More information on moves can be found in the <a href="https://revbayes.github.io/tutorials/mcmc/binomial.html" class="external-link">MCMC tutorial</a>.</p>
<p>Once our turnover is defined, we can also monitor our extinction values like so:</p>
<div class="sourceCode" id="cb8"><pre class="downlit sourceCode r">
<code class="sourceCode R">    <span class="va">extinction_rate</span> <span class="op">:=</span> <span class="va">turnover</span><span class="op">*</span><span class="va">speciation_rate</span>
    <span class="va">diversification</span> <span class="op">:=</span> <span class="va">speciation_rate</span> <span class="op">-</span> <span class="va">extinction_rate</span></code></pre></div>
<p>Next, we will define the sampling in the present. Cinctans are extinct. We will rescale our times such that the last appearance of Cinctans in the fossil record is the ‘present’. Previous studies indicate that about half of Cinctans that existed them are in this analysis <span class="citation">(Zamora, Rahman, and Smith 2013)</span>. We will treat $ $ as a known quantity, a constant node. We will therefore, not specify any moves on this parameter.</p>
<div class="sourceCode" id="cb9"><pre class="downlit sourceCode r">
<code class="sourceCode R">    <span class="va">rho</span> <span class="op">&lt;-</span> <span class="fl">.506</span></code></pre></div>
<p>Our data is made up of fossils. We also need to define the rate at which fossils are recovered on the tree. This is the fossil sampling rate (<span class="math inline">\(\psi\)</span> in Fig. 3). This is also referred to in the literature as the <code>recovery</code> rate. Prior research indicates that an exponential distribution with parameter 3.892 should be adequate.</p>
<div class="sourceCode" id="cb10"><pre class="downlit sourceCode r">
<code class="sourceCode R">    <span class="va">psi</span> <span class="op">~</span> <span class="fu">dnExponential</span><span class="op">(</span><span class="fl">3.892</span><span class="op">)</span> 
    <span class="fu">moves.append</span><span class="op">(</span><span class="fu">mvScale</span><span class="op">(</span><span class="va">psi</span>, lambda<span class="op">=</span><span class="fl">0.01</span>, weight<span class="op">=</span><span class="fl">1</span><span class="op">)</span><span class="op">)</span>
    <span class="fu">moves.append</span><span class="op">(</span><span class="fu">mvScale</span><span class="op">(</span><span class="va">psi</span>, lambda<span class="op">=</span><span class="fl">0.1</span>,  weight<span class="op">=</span><span class="fl">1</span><span class="op">)</span><span class="op">)</span>
    <span class="fu">moves.append</span><span class="op">(</span><span class="fu">mvScale</span><span class="op">(</span><span class="va">psi</span>, lambda<span class="op">=</span><span class="fl">1</span>,    weight<span class="op">=</span><span class="fl">1</span><span class="op">)</span><span class="op">)</span></code></pre></div>
<p>If you do not have a good intution for what this distribution looks like, you can visualize it below.</p>
<div class="sourceCode" id="cb11"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://ggplot2.tidyverse.org" class="external-link">ggplot2</a></span><span class="op">)</span>

<span class="va">draws</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/Exponential.html" class="external-link">rexp</a></span><span class="op">(</span><span class="fl">1000</span>, <span class="fl">3.891</span><span class="op">)</span>
<span class="fu"><a href="https://rdrr.io/r/graphics/hist.html" class="external-link">hist</a></span><span class="op">(</span><span class="va">draws</span><span class="op">)</span></code></pre></div>
<p><img src="RB_Total_Evidence_Tutorial_files/figure-html/unnamed-chunk-11-1.png" width="700"></p>
</div>
<div class="section level4">
<h4 id="the-origin-time">The Origin Time<a class="anchor" aria-label="anchor" href="#the-origin-time"></a>
</h4>
<p>Finally, we need to define an origin time for the Cinctan group. Because we are rescaling the analysis to the treat the ‘present’ as last observation of Cinctans, our origin time will be drawn from a uniform distribution between 10.2 and 15.2 mya. In actuality, this corresponds to 508 to 513 million years ago.</p>
<div class="sourceCode" id="cb12"><pre class="downlit sourceCode r">
<code class="sourceCode R">
    <span class="va">origin_time</span> <span class="op">~</span> <span class="fu">dnUnif</span><span class="op">(</span><span class="fl">10.2</span>, <span class="fl">15.2</span><span class="op">)</span>;
    <span class="fu">moves.append</span><span class="op">(</span><span class="fu">mvSlide</span><span class="op">(</span><span class="va">origin_time</span>, delta<span class="op">=</span><span class="fl">0.01</span>, weight<span class="op">=</span><span class="fl">5.0</span><span class="op">)</span><span class="op">)</span>
    <span class="fu">moves.append</span><span class="op">(</span><span class="fu">mvSlide</span><span class="op">(</span><span class="va">origin_time</span>, delta<span class="op">=</span><span class="fl">0.1</span>,  weight<span class="op">=</span><span class="fl">5.0</span><span class="op">)</span><span class="op">)</span>
    <span class="fu">moves.append</span><span class="op">(</span><span class="fu">mvSlide</span><span class="op">(</span><span class="va">origin_time</span>, delta<span class="op">=</span><span class="fl">1</span>,    weight<span class="op">=</span><span class="fl">5.0</span><span class="op">)</span><span class="op">)</span></code></pre></div>
</div>
<div class="section level4">
<h4 id="the-fbd-distribution-object">The FBD Distribution Object<a class="anchor" aria-label="anchor" href="#the-fbd-distribution-object"></a>
</h4>
<p>All the parameters of the FBD process have now been specified. The next step is to use these parameters to define the FBD tree prior distribution, which we will call <code>fbd_dist</code>. We will use this distribution to simulate a starting tree.</p>
<div class="sourceCode" id="cb13"><pre class="downlit sourceCode r">
<code class="sourceCode R">
    <span class="va">fbd_dist</span> <span class="op">=</span> <span class="fu">dnFBDP</span><span class="op">(</span>origin<span class="op">=</span><span class="va">origin_time</span>, lambda<span class="op">=</span><span class="va">speciation_rate</span>, mu<span class="op">=</span><span class="va">extinction_rate</span>, psi<span class="op">=</span><span class="va">psi</span>, rho<span class="op">=</span><span class="va">rho</span>, taxa<span class="op">=</span><span class="va">taxa</span><span class="op">)</span></code></pre></div>
<p>There has been a good amount of prior work on Cinctans, and we are able to define the ingroup for the Cinctans. For our taxa without phylogenetic characters, this allows us to tell the model that those taxa belong inside the ingroup. The model can then marginalize over their exact placement, and use the age information to date the total ingroup.</p>
<div class="sourceCode" id="cb14"><pre class="downlit sourceCode r">
<code class="sourceCode R">
<span class="va">ingroup</span> <span class="op">=</span> <span class="fu">clade</span><span class="op">(</span><span class="st">"Ctenocystis_utahensis"</span>,<span class="st">"Gyrocystis_platessa"</span>,<span class="st">"Gyrocystis_testudiformis"</span>,<span class="st">"Gyrocystis_cruzae"</span>,<span class="st">"Gyrocystis_badulesiensis"</span>, <span class="st">"Gyrocystis_erecta"</span>,<span class="st">"Progyrocystis_disjuncta"</span>,<span class="st">"Protocinctus_mansillaensis"</span>,<span class="st">"Elliptocinctus_barrandei"</span>,<span class="st">"Elliptocinctus_vizcainoi"</span>,<span class="st">"Sucocystis_theronensis"</span>,<span class="st">"Sucocystis_bretoni"</span>,<span class="st">"Lignanicystis_barriosensis"</span>,<span class="st">"Undatacinctus_undata"</span>,<span class="st">"Sucocystis_acrofera"</span>,<span class="st">"Undatacinctus_quadricornuta"</span>,<span class="st">"Undatacinctus_melendezi"</span>,<span class="st">"Sotocinctus_ubaghsi"</span>,<span class="st">"Ludwigicinctus_truncatus"</span>,<span class="st">"Graciacystis_ambigua"</span>,<span class="st">"Nelegerocystis_ivantzovi"</span>,<span class="st">"Rozanovicystis_triangularis"</span>,<span class="st">"Davidocinctus_pembrokensis"</span><span class="op">)</span>
<span class="va">constraints</span> <span class="op">=</span> <span class="fu">v</span><span class="op">(</span><span class="va">ingroup</span><span class="op">)</span></code></pre></div>
<p>Next, we will draw a starting tree out of this distribution. This will be a tree that is feasible given our model parameters, and consistent with our clade constraints.</p>
<div class="sourceCode" id="cb15"><pre class="downlit sourceCode r">
<code class="sourceCode R">    <span class="va">fbd_tree</span> <span class="op">~</span> <span class="fu">dnConstrainedTopology</span><span class="op">(</span><span class="va">fbd_dist</span>, constraints<span class="op">=</span><span class="va">constraints</span><span class="op">)</span></code></pre></div>
</div>
<div class="section level4">
<h4 id="moves-on-the-tree-topology-and-node-ages">Moves on the Tree Topology and Node Ages<a class="anchor" aria-label="anchor" href="#moves-on-the-tree-topology-and-node-ages"></a>
</h4>
<p>Fossils require some special moves we have not yet seen in any of the tutorials. Firstly, there is <code>mvFNPR</code>, which makes changes to the tree with the knowledge that some tips may not be contemporaneous. <code>mvCollapseExpandFossilBranch</code> allows fossils to transiton between being sampled ancestors and tips. The <code>TimeSlide</code> moves allow us to sample values for node and origin ages.</p>
<div class="sourceCode" id="cb16"><pre class="downlit sourceCode r">
<code class="sourceCode R">    <span class="fu">moves.append</span><span class="op">(</span><span class="fu">mvFNPR</span><span class="op">(</span><span class="va">fbd_tree</span>, weight<span class="op">=</span><span class="fl">15.0</span><span class="op">)</span><span class="op">)</span>
    <span class="fu">moves.append</span><span class="op">(</span><span class="fu">mvCollapseExpandFossilBranch</span><span class="op">(</span><span class="va">fbd_tree</span>, <span class="va">origin_time</span>, weight<span class="op">=</span><span class="fl">6.0</span><span class="op">)</span><span class="op">)</span>
    <span class="fu">moves.append</span><span class="op">(</span><span class="fu">mvNodeTimeSlideUniform</span><span class="op">(</span><span class="va">fbd_tree</span>, weight<span class="op">=</span><span class="fl">40.0</span><span class="op">)</span><span class="op">)</span>
    <span class="fu">moves.append</span><span class="op">(</span><span class="fu">mvRootTimeSlideUniform</span><span class="op">(</span><span class="va">fbd_tree</span>, <span class="va">origin_time</span>, weight<span class="op">=</span><span class="fl">5.0</span><span class="op">)</span><span class="op">)</span></code></pre></div>
</div>
<div class="section level4">
<h4 id="sampling-fossil-occurrence-ages">Sampling Fossil Occurrence Ages<a class="anchor" aria-label="anchor" href="#sampling-fossil-occurrence-ages"></a>
</h4>
<p>Next, we need to account for uncertainty in the age estimates of our fossils using the observed minimum and maximum stratigraphic ages provided in the file <code>cinctans_fossil_intervals.tsv</code>. These values are were obtained and cleaned from the Paleobiology Database. First, we read this file into a matrix called <code>intervals</code>.</p>
<div class="sourceCode" id="cb17"><pre class="downlit sourceCode r">
<code class="sourceCode R">    <span class="va">intervals</span> <span class="op">=</span> <span class="fu">readDataDelimitedFile</span><span class="op">(</span>file<span class="op">=</span><span class="st">"data/cincta_fossil_intervals_FA.tsv"</span>, header<span class="op">=</span><span class="va">true</span><span class="op">)</span></code></pre></div>
<p>Next, we loop over this matrix. For each fossil observation, we create a uniform random variable representing the likelihood. In this equation <span class="math inline">\(t_i\)</span> is the fossil age. <span class="math inline">\(a_i\)</span> and <span class="math inline">\(b_i\)</span> are the minimum and maximum edges of the fossil age range. And so, we treat the fossil age as being drawn from a uniform distribution between <span class="math inline">\((t_i - b_i)\)</span> and <span class="math inline">\((t_i - a_i)\)</span></p>
<div class="sourceCode" id="cb18"><pre class="downlit sourceCode r">
<code class="sourceCode R">
  <span class="va">intervals</span> <span class="op">=</span> <span class="fu">readDataDelimitedFile</span><span class="op">(</span>file<span class="op">=</span><span class="st">"data/cincta_fossil_intervals_FA.tsv"</span>, header<span class="op">=</span><span class="va">true</span><span class="op">)</span>
  <span class="kw">for</span><span class="op">(</span><span class="va">i</span> <span class="kw">in</span> <span class="fl">1</span><span class="op">:</span><span class="fu">intervals.size</span><span class="op">(</span><span class="op">)</span><span class="op">)</span>
  <span class="op">{</span>
      <span class="va">taxon</span>  <span class="op">=</span> <span class="va">intervals</span><span class="op">[</span><span class="va">i</span><span class="op">]</span><span class="op">[</span><span class="fl">1</span><span class="op">]</span>
      <span class="va">a_i</span> <span class="op">=</span> <span class="va">intervals</span><span class="op">[</span><span class="va">i</span><span class="op">]</span><span class="op">[</span><span class="fl">2</span><span class="op">]</span>
      <span class="va">b_i</span> <span class="op">=</span> <span class="va">intervals</span><span class="op">[</span><span class="va">i</span><span class="op">]</span><span class="op">[</span><span class="fl">3</span><span class="op">]</span>
      <span class="va">t</span><span class="op">[</span><span class="va">i</span><span class="op">]</span> <span class="op">:=</span> <span class="fu">tmrca</span><span class="op">(</span><span class="va">fbd_tree</span>, <span class="fu">clade</span><span class="op">(</span><span class="va">taxon</span><span class="op">)</span><span class="op">)</span>
  
      <span class="va">fossil</span><span class="op">[</span><span class="va">i</span><span class="op">]</span> <span class="op">&lt;-</span> <span class="va">a_i</span>
      <span class="va">fossil</span><span class="op">[</span><span class="va">i</span><span class="op">]</span> <span class="op">~</span> <span class="fu">dnSoftBoundUniformNormal</span><span class="op">(</span><span class="va">t</span><span class="op">[</span><span class="va">i</span><span class="op">]</span> <span class="op">-</span> <span class="va">b_i</span>, <span class="va">t</span><span class="op">[</span><span class="va">i</span><span class="op">]</span> <span class="op">-</span> <span class="va">a_i</span>, sd <span class="op">=</span> <span class="fl">2</span>, p <span class="op">=</span> <span class="fl">0.025</span><span class="op">)</span>
  <span class="op">}</span></code></pre></div>
<p>Finally, we add a move that samples the ages of the fossil nodes on the tree.</p>
<div class="sourceCode" id="cb19"><pre class="downlit sourceCode r">
<code class="sourceCode R">  <span class="fu">moves.append</span><span class="op">(</span><span class="fu">mvFossilTimeSlideUniform</span><span class="op">(</span><span class="va">fbd_tree</span>, <span class="va">origin_time</span>, weight<span class="op">=</span><span class="fl">5.0</span><span class="op">)</span><span class="op">)</span></code></pre></div>
<p>We are also going to write the number of sampled ancestors in our analysis to our log files. You may be interested in this value.</p>
<div class="sourceCode" id="cb20"><pre class="downlit sourceCode r">
<code class="sourceCode R">    <span class="va">num_samp_anc</span> <span class="op">:=</span> <span class="fu">fbd_tree.numSampledAncestors</span><span class="op">(</span><span class="op">)</span></code></pre></div>
</div>
</div>
</div>
<div class="section level2">
<h2 id="clock-model">Clock model<a class="anchor" aria-label="anchor" href="#clock-model"></a>
</h2>
<p>We will use the clock model we specified in the <a href="https://dwbapst.github.io/PaleoSoc_phylo_short_course_2019/articles/module_07_TripartiteModel2_clock_models/Clock_models_for_character_data.html" class="external-link">previous section</a> again.</p>
<div class="sourceCode" id="cb21"><pre class="downlit sourceCode r">
<code class="sourceCode R">
    <span class="va">ucln_mean</span> <span class="op">~</span> <span class="fu">dnExponential</span><span class="op">(</span><span class="fl">2.0</span><span class="op">)</span>
    <span class="co"># sigma</span>
    <span class="va">ucln_sigma</span> <span class="op">~</span> <span class="fu">dnExponential</span><span class="op">(</span><span class="fl">3.0</span><span class="op">)</span> 
    <span class="co"># Set a deterministic node on sigma^2 </span>
    <span class="va">ucln_var</span> <span class="op">:=</span> <span class="va">ucln_sigma</span> <span class="op">*</span> <span class="va">ucln_sigma</span> 
    <span class="va">ucln_mu</span> <span class="op">:=</span> <span class="fu">ln</span><span class="op">(</span><span class="va">ucln_mean</span><span class="op">)</span> <span class="op">-</span> <span class="op">(</span><span class="va">ucln_var</span> <span class="op">*</span> <span class="fl">0.5</span><span class="op">)</span>
    <span class="fu">moves.append</span><span class="op">(</span><span class="fu">mvScale</span><span class="op">(</span><span class="va">ucln_mean</span>, lambda<span class="op">=</span><span class="fl">1.0</span>, tune<span class="op">=</span><span class="va">true</span>, weight<span class="op">=</span><span class="fl">4.0</span><span class="op">)</span><span class="op">)</span>
    <span class="fu">moves.append</span><span class="op">(</span><span class="fu">mvScale</span><span class="op">(</span><span class="va">ucln_sigma</span>, lambda<span class="op">=</span><span class="fl">0.5</span>, tune<span class="op">=</span><span class="va">true</span>, weight<span class="op">=</span><span class="fl">4.0</span><span class="op">)</span><span class="op">)</span>
    
    <span class="kw">for</span> <span class="op">(</span><span class="va">i</span> <span class="kw">in</span> <span class="fl">1</span><span class="op">:</span><span class="va">num_branches</span><span class="op">)</span><span class="op">{</span>
    <span class="va">branch_rate_var</span><span class="op">[</span><span class="va">i</span><span class="op">]</span> <span class="op">~</span> <span class="fu">dnLognormal</span><span class="op">(</span><span class="va">ucln_mu</span>, <span class="va">ucln_sigma</span><span class="op">)</span>
    <span class="fu">moves.append</span><span class="op">(</span><span class="fu">mvScale</span><span class="op">(</span><span class="va">branch_rate_var</span><span class="op">[</span><span class="va">i</span><span class="op">]</span>, lambda<span class="op">=</span><span class="fl">1</span>, tune<span class="op">=</span><span class="va">true</span>, weight<span class="op">=</span><span class="fl">2.0</span><span class="op">)</span><span class="op">)</span>
    <span class="op">}</span>
    <span class="fu">moves.append</span><span class="op">(</span><span class="fu">mvVectorScale</span><span class="op">(</span><span class="va">branch_rate_var</span>,lambda<span class="op">=</span><span class="fl">1.0</span>,tune<span class="op">=</span><span class="va">true</span>,weight<span class="op">=</span><span class="fl">2.0</span><span class="op">)</span><span class="op">)</span>
    <span class="fu">moves.append</span><span class="op">(</span><span class="fu">mvVectorSingleElementScale</span><span class="op">(</span><span class="va">branch_rate_var</span>,lambda<span class="op">=</span><span class="fl">30.0</span>,tune<span class="op">=</span><span class="va">true</span>,weight<span class="op">=</span><span class="fl">1.0</span><span class="op">)</span><span class="op">)</span></code></pre></div>
</div>
<div class="section level2">
<h2 id="morphological-change-model">Morphological Change Model<a class="anchor" aria-label="anchor" href="#morphological-change-model"></a>
</h2>
<p>We will also use the morphology model defined in the <a href="https://dwbapst.github.io/PaleoSoc_phylo_short_course_2019/articles/module_06_TripartiteModel1_morph_change_models/RB_MCMC_Discrete_Morph.html" class="external-link">tree inference section</a></p>
<div class="sourceCode" id="cb22"><pre class="sourceCode rb"><code class="sourceCode ruby"><span id="cb22-1"><a href="#cb22-1" aria-hidden="true"></a></span>
<span id="cb22-2"><a href="#cb22-2" aria-hidden="true"></a>    alpha_morpho ~ dnUniform( <span class="dv">0</span>, 1E6 )</span>
<span id="cb22-3"><a href="#cb22-3" aria-hidden="true"></a>    rates_morpho := fnDiscretizeGamma( alpha_morpho, alpha_morpho, <span class="dv">4</span> )</span>
<span id="cb22-4"><a href="#cb22-4" aria-hidden="true"></a>    <span class="co">#Moves on the parameters of the Gamma distribution.</span></span>
<span id="cb22-5"><a href="#cb22-5" aria-hidden="true"></a>    moves.append(mvScale(alpha_morpho, lambda=<span class="dv">1</span>, weight=<span class="fl">2.0</span>))</span>
<span id="cb22-6"><a href="#cb22-6" aria-hidden="true"></a></span>
<span id="cb22-7"><a href="#cb22-7" aria-hidden="true"></a>    n_max_states &lt;- <span class="dv">7</span></span>
<span id="cb22-8"><a href="#cb22-8" aria-hidden="true"></a>    idx = <span class="dv">1</span></span>
<span id="cb22-9"><a href="#cb22-9" aria-hidden="true"></a>    morpho_bystate[<span class="dv">1</span>] &lt;- morpho</span>
<span id="cb22-10"><a href="#cb22-10" aria-hidden="true"></a>    <span class="kw">for</span> (i <span class="kw">in</span> <span class="dv">2</span><span class="st">:n_max_states</span>) {</span>
<span id="cb22-11"><a href="#cb22-11" aria-hidden="true"></a>        <span class="co"># make local tmp copy of data</span></span>
<span id="cb22-12"><a href="#cb22-12" aria-hidden="true"></a>        <span class="co"># only keep character blocks with state space equal to size i</span></span>
<span id="cb22-13"><a href="#cb22-13" aria-hidden="true"></a>        morpho_bystate[i] &lt;- morpho</span>
<span id="cb22-14"><a href="#cb22-14" aria-hidden="true"></a>        morpho_bystate[i].setNumStatesPartition(i)</span>
<span id="cb22-15"><a href="#cb22-15" aria-hidden="true"></a>        <span class="co"># get number of characters per character size wth i-sized states</span></span>
<span id="cb22-16"><a href="#cb22-16" aria-hidden="true"></a>        nc = morpho_bystate[i].nchar()</span>
<span id="cb22-17"><a href="#cb22-17" aria-hidden="true"></a>        <span class="co"># for non-empty character blocks</span></span>
<span id="cb22-18"><a href="#cb22-18" aria-hidden="true"></a>        <span class="kw">if</span> (nc &gt; <span class="dv">0</span>) {</span>
<span id="cb22-19"><a href="#cb22-19" aria-hidden="true"></a>            <span class="co"># make i-by-i rate matrix</span></span>
<span id="cb22-20"><a href="#cb22-20" aria-hidden="true"></a>            q[idx] &lt;- fnJC(i)</span>
<span id="cb22-21"><a href="#cb22-21" aria-hidden="true"></a>    <span class="co"># create model of evolution for the character block</span></span>
<span id="cb22-22"><a href="#cb22-22" aria-hidden="true"></a>            m_morph[idx] ~ dnPhyloCTMC( tree=fbd_tree,</span>
<span id="cb22-23"><a href="#cb22-23" aria-hidden="true"></a>                                        Q=q[idx],</span>
<span id="cb22-24"><a href="#cb22-24" aria-hidden="true"></a>                                        nSites=nc,</span>
<span id="cb22-25"><a href="#cb22-25" aria-hidden="true"></a>                                        siteRates=rates_morpho,</span>
<span id="cb22-26"><a href="#cb22-26" aria-hidden="true"></a>                                        branchRates = branch_rate_var,</span>
<span id="cb22-27"><a href="#cb22-27" aria-hidden="true"></a>                                        type=<span class="st">"Standard"</span>)</span>
<span id="cb22-28"><a href="#cb22-28" aria-hidden="true"></a>    </span>
<span id="cb22-29"><a href="#cb22-29" aria-hidden="true"></a>            <span class="co"># attach the data</span></span>
<span id="cb22-30"><a href="#cb22-30" aria-hidden="true"></a>            m_morph[idx].clamp(morpho_bystate[i])</span>
<span id="cb22-31"><a href="#cb22-31" aria-hidden="true"></a>    </span>
<span id="cb22-32"><a href="#cb22-32" aria-hidden="true"></a>            <span class="co"># increment counter</span></span>
<span id="cb22-33"><a href="#cb22-33" aria-hidden="true"></a>            idx = idx + <span class="dv">1</span></span>
<span id="cb22-34"><a href="#cb22-34" aria-hidden="true"></a>            idx</span>
<span id="cb22-35"><a href="#cb22-35" aria-hidden="true"></a>        }</span>
<span id="cb22-36"><a href="#cb22-36" aria-hidden="true"></a>    }</span></code></pre></div>
</div>
<div class="section level2">
<h2 id="running-our-analysis">Running our analysis<a class="anchor" aria-label="anchor" href="#running-our-analysis"></a>
</h2>
<p>As we have in prior sections, we will now initialize and execute our model. First, we create the model object that contains all of our character change, clock, and tree model parameters and priors.</p>
<div class="sourceCode" id="cb23"><pre class="downlit sourceCode r">
<code class="sourceCode R">    <span class="va">mymodel</span> <span class="op">=</span> <span class="fu">model</span><span class="op">(</span><span class="va">fbd_tree</span><span class="op">)</span></code></pre></div>
<p>Next, we inform RevBayes where we would like to write our sampled parameters.</p>
<div class="sourceCode" id="cb24"><pre class="downlit sourceCode r">
<code class="sourceCode R">
    <span class="fu">monitors.append</span><span class="op">(</span><span class="fu">mnModel</span><span class="op">(</span>filename<span class="op">=</span><span class="st">"output/cinc_dated.log"</span>, printgen<span class="op">=</span><span class="fl">10</span><span class="op">)</span><span class="op">)</span></code></pre></div>
<p>And where we would like to write our trees.</p>
<div class="sourceCode" id="cb25"><pre class="downlit sourceCode r">
<code class="sourceCode R">
    <span class="fu">monitors.append</span><span class="op">(</span><span class="fu">mnFile</span><span class="op">(</span>filename<span class="op">=</span><span class="st">"output/cinc_dated.trees"</span>, printgen<span class="op">=</span><span class="fl">10</span>, <span class="va">fbd_tree</span><span class="op">)</span><span class="op">)</span></code></pre></div>
<p>We can also echo some facets to the screen</p>
<div class="sourceCode" id="cb26"><pre class="downlit sourceCode r">
<code class="sourceCode R">
    <span class="fu">monitors.append</span><span class="op">(</span><span class="fu">mnScreen</span><span class="op">(</span>printgen<span class="op">=</span><span class="fl">10</span>, <span class="va">num_samp_anc</span>, <span class="va">origin_time</span><span class="op">)</span><span class="op">)</span></code></pre></div>
<p>And then we initialize the model.</p>
<div class="sourceCode" id="cb27"><pre class="downlit sourceCode r">
<code class="sourceCode R">
     <span class="va">mymcmc</span> <span class="op">=</span> <span class="fu">mcmc</span><span class="op">(</span><span class="va">mymodel</span>, <span class="va">monitors</span>, <span class="va">moves</span><span class="op">)</span></code></pre></div>
<p>And run it. In a real analysis, you would want to run this for far more than 1000 generations.</p>
<div class="sourceCode" id="cb28"><pre class="downlit sourceCode r">
<code class="sourceCode R">
    <span class="fu">mymcmc.run</span><span class="op">(</span>generations<span class="op">=</span><span class="fl">10000</span><span class="op">)</span></code></pre></div>
<p>And then we quit.</p>
<div class="sourceCode" id="cb29"><pre class="downlit sourceCode r">
<code class="sourceCode R">    <span class="fu"><a href="https://rdrr.io/r/base/quit.html" class="external-link">q</a></span><span class="op">(</span><span class="op">)</span></code></pre></div>
<div class="section level3">
<h3 id="evaluate-and-summarize-your-results">Evaluate and Summarize Your Results<a class="anchor" aria-label="anchor" href="#evaluate-and-summarize-your-results"></a>
</h3>
<p>Once our analysis is complete, we can analyze the results in various ways. One popular software for assessing convergence in a Bayesian analysis is <a href="https://github.com/beast-dev/tracer/releases/tag/v1.7.1" class="external-link">Tracer</a>. More information on evaluating MCMCs can be found in the <a href="https://revbayes.github.io/tutorials/mcmc/binomial.html" class="external-link">MCMC tutorial</a>.</p>
<p>We can create a variety of summary trees in RevBayes. Common ones include the maximum clade credibility tree, and the consensus tree. The maximum clade credibility tree is the tree that maximuizes the cumulative clade probabilities on that tree. This metric has become popular, as it always yields a tree that is included in the posterior sample. This is in contrast to a strict or semis-strict consensus tree, which includes all clades that have over a specified posterior probability, and may not have been sampled in the analysis. Below, we calculate both.</p>
<div class="sourceCode" id="cb30"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">trace</span> <span class="op">=</span> <span class="fu">readTreeTrace</span><span class="op">(</span><span class="st">"output/cinc_dated.trees"</span><span class="op">)</span>
<span class="fu">mccTree</span><span class="op">(</span><span class="va">trace</span>, file <span class="op">=</span> <span class="st">"output/mccTree.tre"</span><span class="op">)</span>
<span class="fu">conTree</span><span class="op">(</span><span class="va">trace</span>, file <span class="op">=</span> <span class="st">"output/conTree.tre"</span><span class="op">)</span></code></pre></div>
<p>The resultant tree files can be viewed in popular tree viewers such as <a href="https://github.com/rambaut/figtree/releases" class="external-link">FigTree</a> or <a href="https://icytree.org/" class="external-link">IcyTree</a>. ## References</p>
<div id="refs" class="references hanging-indent">
<div id="ref-Heath2014">
<p>Heath, Tracy A, John P Huelsenbeck, and Tanja Stadler. 2014. “The fossilized birth-death process for coherent calibration of divergence-time estimates.” <em>Proceedings of the National Academy of Sciences</em> 111 (29): E2957–E2966.</p>
</div>
<div id="ref-Stadler2010">
<p>Stadler, T. 2010. “Sampling-through-time in birth-death trees.” <em>Journal of Theoretical Biology</em> 267 (3): 396–404.</p>
</div>
<div id="ref-zamora2013">
<p>Zamora, Samuel, Imran A Rahman, and Andrew B Smith. 2013. “The Ontogeny of Cinctans (Stem-Group Echinodermata) as Revealed by a New Genus, Graciacystis, from the Middle Cambrian of Spain.” <em>Palaeontology</em> 56 (2): 399–410.</p>
</div>
</div>
</div>
</div>
  </div>

  <div class="col-md-3 hidden-xs hidden-sm" id="pkgdown-sidebar">

        <nav id="toc" data-toggle="toc"><h2 data-toc-skip>Contents</h2>
    </nav>
</div>

</div>



      <footer><div class="copyright">
  <p></p>
<p>Developed by The package maintainer.</p>
</div>

<div class="pkgdown">
  <p></p>
<p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.0.2.</p>
</div>

      </footer>
</div>

  


  

  </body>
</html>
