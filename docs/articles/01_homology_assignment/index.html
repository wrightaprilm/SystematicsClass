<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Morphological Homology Assignment • Systematics2020</title>
<!-- jquery --><script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.4.1/jquery.min.js" integrity="sha256-CSXorXvZcTkaix6Yvo6HppcZGetbYMGWSFlBw8HfCJo=" crossorigin="anonymous"></script><!-- Bootstrap --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/css/bootstrap.min.css" integrity="sha256-bZLfwXAP04zRMK2BjiO8iu9pf4FbLqX6zitd+tIvLhE=" crossorigin="anonymous">
<script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/js/bootstrap.min.js" integrity="sha256-nuL8/2cJ5NDSSwnKD8VqreErSWHtnEP9E7AySL+1ev4=" crossorigin="anonymous"></script><!-- bootstrap-toc --><link rel="stylesheet" href="../../bootstrap-toc.css">
<script src="../../bootstrap-toc.js"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous">
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous">
<!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- pkgdown --><link href="../../pkgdown.css" rel="stylesheet">
<script src="../../pkgdown.js"></script><meta property="og:title" content="Morphological Homology Assignment">
<meta property="og:description" content="Systematics2020">
<!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]-->
</head>
<body data-spy="scroll" data-target="#toc">
    <div class="container template-article">
      <header><div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <span class="navbar-brand">
        <a class="navbar-link" href="../../index.html">Systematics2020</a>
        <span class="version label label-default" data-toggle="tooltip" data-placement="bottom" title="Released version">0.1.0</span>
      </span>
    </div>

    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
<li>
  <a href="../../index.html">
    <span class="fas fa-home fa-lg"></span>
     
  </a>
</li>
<li>
  <a href="../../reference/index.html">Reference</a>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" aria-expanded="false">
    Articles
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu">
<li>
      <a href="../../articles/00_Basics_of_R/index.html">R Reminder</a>
    </li>
    <li>
      <a href="../../articles/01_homology_assignment/index.html">Morphological Homology Assignment</a>
    </li>
    <li>
      <a href="../../articles/02_molecular_homology/index.html">Molecular Homology Assignment</a>
    </li>
    <li>
      <a href="../../articles/03_CTMC/index.html">Nucleotide substitution models</a>
    </li>
    <li>
      <a href="../../articles/03_ParsimonyAndModels/index.html">PAUP, parsimony, and nucletoide substitution models</a>
    </li>
    <li>
      <a href="../../articles/03_tutorial_structure/index.html">Setting Up RevBayes</a>
    </li>
    <li>
      <a href="../../articles/04_Discrete_Morphology/05_RB_MCMC_Discrete_Morph.html">Discrete morphology - Models and Tree Inference</a>
    </li>
    <li>
      <a href="../../articles/04_tutorial_structure/index.html">Tutorial Structure</a>
    </li>
    <li>
      <a href="../../articles/05_pandemic_week/index.html">Pandemic Week</a>
    </li>
    <li>
      <a href="../../articles/06_models/index.html">Nucleotide substitution models</a>
    </li>
    <li>
      <a href="../../articles/08_final/index.html">Final Project</a>
    </li>
  </ul>
</li>
      </ul>
<ul class="nav navbar-nav navbar-right"></ul>
</div>
<!--/.nav-collapse -->
  </div>
<!--/.container -->
</div>
<!--/.navbar -->

      

      </header><script src="index_files/header-attrs-2.11/header-attrs.js"></script><div class="row">
  <div class="col-md-9 contents">
    <div class="page-header toc-ignore">
      <h1 data-toc-skip>Morphological Homology Assignment</h1>
            
      
      
      <div class="hidden name"><code>index.Rmd</code></div>

    </div>

    
    
<p>Core to the idea of phylogenetics and systematics is the idea of homology. You’ll read a bunch about homology in class. <strong>Homology</strong> refers to two structures in different taxa having a common evolutionary origin. The classical example is the wings of a bat, our arms, and the forearms of a cat or dog. We know that these characteristics are homologous based on several criteria:</p>
<ul>
<li>Bones being in the same place</li>
<li>Bones being shaped and joined similarly</li>
<li>Developmental studies showing the same cells forming each of these structures</li>
<li>Fossils from different stages in evolution</li>
</ul>
<p>Historically, each of these things has been seen as evidence that a structure is homologous. Depending on what raw material you have available, you might have all of the above pieces of evidence, or only one or two. Paleontologists, for example, rarely have developmental information.</p>
<p>Traits that are considered to be homologous are often broken up into character states. A state is a form of a character. States can be discrete,or they can be continuous.</p>
<div class="figure">
<img src="img/Fig5.png" alt=""><p class="caption">Fig. 1: Different character concepts</p>
</div>
<p>Knowing whether or not a character in one organism is homologous to a character in another forms the basis of phylogenetics. If a character isn’t homologous, we can’t model it’s evolution over time, whether we’re doing parsimony modeling or likelihood or Bayesian.</p>
<div id="activity-break" class="section level2">
<h2 class="hasAnchor">
<a href="#activity-break" class="anchor"></a>Activity break</h2>
<p>In front of you are skulls. Each group of two gets two skulls. In small groups, look at the skulls and pick one feature on the skull. Decide what character stat each skull has for that character, and note this down, along with the diagnoses of each character.</p>
</div>
<div id="molecular-homology-assessment" class="section level2">
<h2 class="hasAnchor">
<a href="#molecular-homology-assessment" class="anchor"></a>Molecular Homology Assessment</h2>
<p>Morphological homology assignment isn’t easy. People often work for years to develop the skills to do it. Continuous characters, such as geometric morphometric landmarks, often have more technical tricks to collect. Technologies to collect these automatically are also being developed.</p>
<p>In the same way that morphological homology forms the basis of morphological phylogenetics, molecular homology forms the basis of molecular phylogenetics. Instead of the homology of physical structures, however, we are often assessing the homology of sites in the genome. In the 80s, 90s and 2000s, this often meant figuring out which sites in a known gene are homologous. For example, is site 132 in COII in <em>Canis lupus</em> homologous to site 132 in <em>Nerodia rhombifer</em>? Or have insertions and deletions meant that site 132 in dogs is homologous with site 363 in water snakes? Increasingly, we no longer even have the name of the gene to help us - we may be using data sources such as ddRADseq or targeted capture to try to find homology. These data are far too large for a human to manually or by-eye assess homology.</p>
<p>So what are the algorithms for homology detection in molecular data? You’ve probably heard the term <em>alignment</em> before. This is where we’ll begin.</p>
<p>The basic concept to alignment is that we use a scoring matrix to asses how likely or unlikely different types of changes are within a nucleotide sequence. In closely-related taxa, this is often fairly easy.</p>
<p><img src="img/Seqs.png" alt="Hypothetical sequences"> We can see in this sequence that there is one subsitution between the two seqeunces:</p>
<p><img src="img/subs.png" alt="Hypothetical sequences with highlighting"> We can also have deletion events.</p>
<div class="figure">
<img src="img/Del.png" alt=""><p class="caption">Hypothetical sequences with highlighting</p>
</div>
<p>We typically solve this by inserting a “gap”: <img src="img/gap.png" alt="Gapped"></p>
<p>But the longer evolutionary time separates two lineages, the more change events there will be:</p>
<div class="figure">
<img src="img/gaps+subs.png" alt=""><p class="caption">gap and subs</p>
</div>
<p>So how do we figure it out? How do we sort out which columns in the alignment are homologous with which? The goal of multiple sequence alignment (MSA) is to introduce gaps such that each residue in a <em>column</em> will be homologous. At the end of this process, we have a data matrix in which the residues in each column are hypothesized to be descended from a residue in a common ancestor.</p>
<p>This typically takes the form of several possible moves:<br>
1. Rewarding matches.<br>
* Add to alignment score<br>
2. Penalize opening gaps.<br>
* Decrement score. Typically 5 points to open.<br>
3. Penalize rare substitutions, but not slight differences.<br>
* Decrement score.<br>
4. Penalize extending gaps.</p>
<p>The alignment that maximizes the total score is considered to be the best. There are multiple ways of achieving an alignment. We will cover three of them today.</p>
<p>First, let’s do a completely naive scoring matrix to score the above sequences. We will assume a gap opening penalty of one, and a gap extension penalty of one, and that every substitution has a score of one. What is the score on the above matrix?</p>
<p>We often use what are called <em>scoring matrices</em> to obtain the score of individual substitutions. We will talk about many types of substitution matrices throughout the semester. One that is commonly used in alignment is BLOSUM 62, which is based on empirically-calculated likelihoods of seeing different types of substitutions.</p>
<div class="figure">
<img src="img/blosum62.png" alt=""><p class="caption">BLOSUM62</p>
</div>
<p>Try recalculating the score of the rat-mouse data under this matrix.</p>
<p>Now, we mostly don’t do alignments by hand. There are three major categories of multiple sequence aligners. We’ll talk briefly about each before doing genome-scale homology assessment next week.</p>
<p>##Progressive MSA</p>
<p>Pairwise Multiple Sequence Alignment does exactly what we discussed above, for all your sequences. Typically, this is performed by first performing a pairwise MSA, as we did above, between the two sequences with the least differences. Then, sequences are added in the order of least differences. Progressive alignments score different alignment possibilities based on the alignment and user-specified scoring matrices, such as BLOSUM 62, or others. Clustal is an example of progressive alignment, but is known to be fairly innaccurate. Another example is T-COFFEE.</p>
<p>##Iterative Approaches to MSA</p>
<p>Progressive aligners make a set of assumptions, and apply those assumptions to the whole set of sequences across a phylogeny. But many datasets are fairly large, and may have different evolutionary dynamics across the tree. <em>Iterative aligners</em> use tree information to guide the process of making the alignment. For example, PASTA, below, uses this approach. This is broadly similar to how we will approach alignment next week.</p>
<div class="figure">
<img src="img/pasta.jpg" alt=""><p class="caption">Diagram of Sate/PASTA Algorithm</p>
</div>
<p>##Coestimation of MSA and Phylogeny</p>
<p>Phylogenetic esitmation generally assumes that we know the alignment without error. We’ve already seen in our examples cases where we do not get the same alignment between methods. This is particularly true in areas that are hard to align. For example, in the below paper, they estimate a tree for fungi, which are deeply-diverged, and very diverse. The alignment has many problematic regions. What they showed in this paper was that by not accounting for the alignment uncertainty, support was overestimated for their tree hypothesis.</p>
<div class="figure">
<img src="img/Lutzoni.png" alt=""><p class="caption">Lutzoni paper</p>
</div>
<p>We haven’t talked about Bayesian estimation, so I’m going to say very little on joint estimation of alignment and topology. This is a method that allows for a wide range of models to be deployed in order to estimate both the alignment and the tree, and shows great promise for difficult alignment issues. We have a few floating open labs throughout the semester, so if this is a topic of interest to people, we can revisit it then.</p>
<p>The primary software that performs this analysis is <a href="http://www.bali-phy.org/Tutorial3.html">Bali-Phy</a>, which is described <a href="http://www.bali-phy.org/Redelings_and_Suchard_2005.pdf">here</a>.</p>
</div>
<div id="alignment-homework" class="section level2">
<h2 class="hasAnchor">
<a href="#alignment-homework" class="anchor"></a>Alignment Homework</h2>
<div id="some-of-these-questions-do-not-have-a-right-answer-" class="section level3">
<h3 class="hasAnchor">
<a href="#some-of-these-questions-do-not-have-a-right-answer-" class="anchor"></a>Some of these questions do not have a right answer.</h3>
<p>Fill out this worksheet (it can be opened in a plain text editor, like TextEdit [Mac] or TextWrangler [Mac] or Notepad [Windows]. Commit and push it to your copy of the course repo. I will pull your copies Friday at 5, and try to have comments for you by next class period, when we will discuss them.</p>
<p>Feel free to work in groups, and discuss the assignments as needed. However, I do expect you to turn in your own copy, with answers in your own words.</p>
<ol style="list-style-type: decimal">
<li><p>Some algorithms treat a gap as a single penalty value, regardless of how large the gap is. Others assess a gap opening penalty, then a smaller gap extension penalty. When (i.e. what kind of biological scenarios) might you think it might be better to use one algorithm over the other?</p></li>
<li><p>Breaking problems into subproblems is a common way to attack a tough problem. In the case of iterative alignments, we break the tree into smaller pieces. Are there biological questions for which you expect this would not be helpful?</p></li>
<li><p>Briefly describe what you’re hoping to get out of this class. If you have empirical data, please explain what the data are, and what you’d like to do with them.</p></li>
</ol>
</div>
</div>
  </div>

  <div class="col-md-3 hidden-xs hidden-sm" id="pkgdown-sidebar">

        <nav id="toc" data-toggle="toc"><h2 data-toc-skip>Contents</h2>
    </nav>
</div>

</div>



      <footer><div class="copyright">
  <p>Developed by The package maintainer.</p>
</div>

<div class="pkgdown">
  <p>Site built with <a href="https://pkgdown.r-lib.org/">pkgdown</a> 1.6.1.</p>
</div>

      </footer>
</div>

  


  </body>
</html>
